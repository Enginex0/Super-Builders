diff '--color=auto' -ruN /tmp/ksunext-clean/Kconfig /tmp/ksunext-modified/Kconfig
--- /tmp/ksunext-clean/Kconfig	2026-03-01 11:38:05.579439731 +0100
+++ /tmp/ksunext-modified/Kconfig	2026-03-01 11:39:19.784547181 +0100
@@ -104,6 +104,20 @@
 	  - It may not be able to evade detections by apps that implement a good injection detection.
 	  - Effective only on zygote spawned umounted user app process.
 
+config KSU_SUSFS_SUS_KSTAT_REDIRECT
+	bool "SUSFS kstat redirect"
+	depends on KSU_SUSFS_SUS_KSTAT
+	default y
+	help
+	  Redirects kstat lookups to real file metadata for spoofed paths.
+
+config KSU_SUSFS_UNICODE_FILTER
+	bool "Unicode Filter (blocks scoped storage bypass)"
+	depends on KSU_SUSFS
+	default y
+	help
+	  Blocks filesystem path attacks using unicode characters.
+
 endmenu
 
 endmenu
diff '--color=auto' -ruN /tmp/ksunext-clean/ksud.c /tmp/ksunext-modified/ksud.c
--- /tmp/ksunext-clean/ksud.c	2026-03-01 11:38:05.579439731 +0100
+++ /tmp/ksunext-modified/ksud.c	2026-03-01 11:39:57.476979863 +0100
@@ -460,7 +460,7 @@
 					int *value)
 {
 #ifdef CONFIG_KSU_SUSFS
-	if (!ksu_input_hook) {
+	if (!READ_ONCE(ksu_input_hook)) {
 		return 0;
 	}
 #endif // #ifdef CONFIG_KSU_SUSFS
@@ -662,7 +662,7 @@
 	bool ret = schedule_work(&stop_init_rc_hook_work);
 	pr_info("unregister init_rc_hook kprobe: %d!\n", ret);
 #else
-	ksu_init_rc_hook = false;
+	WRITE_ONCE(ksu_init_rc_hook, false);
 	pr_info("stop init_rc_hook\n");
 #endif // #ifndef CONFIG_KSU_SUSFS
 }
@@ -673,7 +673,7 @@
 	bool ret = schedule_work(&stop_execve_hook_work);
 	pr_info("unregister execve kprobe: %d!\n", ret);
 #else
-	ksu_execveat_hook = false;
+	WRITE_ONCE(ksu_execveat_hook, false);
 	pr_info("stop execve_hook\n");
 #endif // #ifndef CONFIG_KSU_SUSFS
 }
@@ -689,7 +689,7 @@
 	bool ret = schedule_work(&stop_input_hook_work);
 	pr_info("unregister input kprobe: %d!\n", ret);
 #else
-	ksu_input_hook = false;
+	WRITE_ONCE(ksu_input_hook, false);
 	pr_info("stop input_hook\n");
 #endif // #ifndef CONFIG_KSU_SUSFS
 }
diff '--color=auto' -ruN /tmp/ksunext-clean/setuid_hook.c /tmp/ksunext-modified/setuid_hook.c
--- /tmp/ksunext-clean/setuid_hook.c	2026-03-01 11:38:05.579439731 +0100
+++ /tmp/ksunext-modified/setuid_hook.c	2026-03-01 11:42:26.973693442 +0100
@@ -37,7 +37,7 @@
 static inline bool is_zygote_normal_app_uid(uid_t uid)
 {
     uid %= 100000;
-    return (uid >= 10000 && uid < 19999);
+    return (uid >= 10000 && uid < 20000);
 }
 
 extern u32 susfs_zygote_sid;
@@ -101,6 +101,9 @@
     uid_t old_uid = current_uid().val;
 
     // We only interest in process spwaned by zygote
+    if (susfs_zygote_sid == 0) {
+        return 0;
+    }
     if (!susfs_is_sid_equal(current_cred(), susfs_zygote_sid)) {
         return 0;
     }
diff '--color=auto' -ruN /tmp/ksunext-clean/supercalls.c /tmp/ksunext-modified/supercalls.c
--- /tmp/ksunext-clean/supercalls.c	2026-03-01 11:38:05.579439731 +0100
+++ /tmp/ksunext-modified/supercalls.c	2026-03-01 11:42:30.065625472 +0100
@@ -1051,6 +1051,12 @@
 			return 0;
 		}
 #endif // #ifdef CONFIG_KSU_SUSFS_SUS_KSTAT
+#ifdef CONFIG_KSU_SUSFS_SUS_KSTAT_REDIRECT
+		if (cmd == CMD_SUSFS_ADD_SUS_KSTAT_REDIRECT) {
+			susfs_add_sus_kstat_redirect(arg);
+			return 0;
+		}
+#endif // #ifdef CONFIG_KSU_SUSFS_SUS_KSTAT_REDIRECT
 #ifdef CONFIG_KSU_SUSFS_SPOOF_UNAME
 		if (cmd == CMD_SUSFS_SET_UNAME) {
 			susfs_set_uname(arg);
